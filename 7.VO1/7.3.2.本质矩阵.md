&emsp;
# Essential Matrix 本质矩阵
## 1 Intro
根据定义, 本质矩阵 $\boldsymbol{E}=\boldsymbol{t}^{\wedge} \boldsymbol{R}$ 。它是一个 $3 \times 3$ 的矩阵, 内有 9 个未知数。那么, 是不是任意一个 $3 \times 3$ 的矩阵都可以被当成本质矩阵呢? 从 $\boldsymbol{E}$ 的构造方式上看, 有以下值得注意的地方:

- 本质矩阵是由对极约束定义的。由于对极约束是等式为零的约束, 所以对 $\boldsymbol{E}$ 乘以任意非零常数后，对极约束依然满足。这称为 $\boldsymbol{E}$ 在不同尺度下是等价的
- 根据 $\boldsymbol{E}=\boldsymbol{t}^{\wedge} \boldsymbol{R}$, 可以证明, 本质矩阵 $\boldsymbol{E}$ 的奇异值必定是 $[\sigma, \sigma, 0]^{\mathrm{T}}$ 的形式。这称为本质矩阵的内在性质
- 由于平移和旋转各有 3 个自由度, 故 $\boldsymbol{t}^{\wedge} \boldsymbol{R}$ 共有 6 个自由度。但由于尺度等价性,故 $\boldsymbol{E}$ 实际上有 5 个自由度
$\boldsymbol{E}$ 具有 5 个自由度的事实, 表明我们最少可以用 5 对点来求解 $\boldsymbol{E}$ 。但是, $\boldsymbol{E}$ 的内在性质是一种非线性性质，在估计时会带来麻烦，因此，也可以只考虑它的尺度等价性，使用 8 对点来估计 $\boldsymbol{E}$以在线性代数框架下求解。

&emsp;
## 2 八点法
下面我们来看八点法是如何工作的

考虑一对匹配点, 它们的归一化坐标为 $\boldsymbol{x}_1=\left[u_1, v_1, 1\right]^{\mathrm{T}}, \boldsymbol{x}_2=\left[u_2, v_2, 1\right]^{\mathrm{T}}$ 。根据对极约束, 有:
$$
\left(u_2, v_2, 1\right)\left(\begin{array}{ccc}
e_1 & e_2 & e_3 \\
e_4 & e_5 & e_6 \\
e_7 & e_8 & e_9
\end{array}\right)\left(\begin{array}{c}
u_1 \\ v_1 \\ 1
\end{array}\right)=0 $$

我们把矩阵 $\boldsymbol{E}$ 展开, 写成向量的形式:
$$
\boldsymbol{e}=\left[e_1, e_2, e_3, e_4, e_5, e_6, e_7, e_8, e_9\right]^{\mathrm{T}}$$

那么对极约束可以写成与 $e$ 有关的线性形式:
$$
\left[u_2 u_1, u_2 v_1, u_2, v_2 u_1, v_2 v_1, v_2, u_1, v_1, 1\right] \cdot \boldsymbol{e}=0
$$

同理, 对于其他点对也有相同的表示。我们把所有点都放到一个方程中, 变成线性方程组 $(u^i, v^i)$

表示第 $i$ 个特征点, 依此类推:
$$
\left(\begin{array}{ccccccccc}
u_2^1 u_1^1 & u_2^1 v_1^1 & u_2^1 & v_2^1 u_1^1 & v_2^1 v_1^1 & v_2^1 & u_1^1 & v_1^1 & 1 \\
u_2^2 u_1^2 & u_2^2 v_1^2 & u_2^2 & v_2^2 u_1^2 & v_2^2 v_1^2 & v_2^2 & u_1^2 & v_1^2 & 1 \\
\vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \\
u_2^8 u_1^8 & u_2^8 v_1^8 & u_2^8 & v_2^8 u_1^8 & v_2^8 v_1^8 & v_2^8 & u_1^8 & v_1^8 & 1
\end{array}\right)\left(\begin{array}{c}
e_1 \\ e_2 \\ e_3 \\ e_4 \\ e_5 \\ e_6 \\ e_7 \\ e_8 \\ e_9
\end{array}\right)=0
$$

这 8 个方程构成了一个线性方程组。它的系数矩阵由特征点位置构成, 大小为 $8 \times 9$。$e$ 位于该矩阵的零空间中。如果系数矩阵是满秩的 (即秩为 8 ), 那么它的零空间维数为 1 , 也就是 $\boldsymbol{e}$ 构成一条线。这与 $\boldsymbol{e}$ 的尺度等价性是一致的。如果 8 对匹配点组成的矩阵满足秩为 8 的条件, 那么 $\boldsymbol{E}$ 的各元素就可由上述方程解得

接下来的问题是如何根据已经估得的本质矩阵 $\boldsymbol{E}$, 恢复出相机的运动 $\boldsymbol{R}, \boldsymbol{t}$ 。这个过程是由奇异值分解 ($SVD$) 得到的。设 $\boldsymbol{E}$ 的 $SVD$ 分解为
$$
\boldsymbol{E}=\boldsymbol{U} \boldsymbol{\Sigma} \boldsymbol{V}^{\mathrm{T}}
$$

其中 $\boldsymbol{U}, \boldsymbol{V}$ 为正交阵, $\boldsymbol{\Sigma}$ 为奇异值矩阵。根据 $\boldsymbol{E}$ 的内在性质，我们知道 $\boldsymbol{\Sigma}=\operatorname{diag}(\sigma, \sigma, 0)$ 。在 $SVD$ 分解中，对于任意一个 $\boldsymbol{E}$ ，存在两个可能的 $\boldsymbol{t}, \boldsymbol{R}$ 与它对应:
$$
\begin{aligned}
& \boldsymbol{t}_1^{\wedge}=\boldsymbol{U} \boldsymbol{R}_Z\left(\frac{\pi}{2}\right) \boldsymbol{\Sigma} \boldsymbol{U}^{\mathrm{T}}, \quad \boldsymbol{R}_1=\boldsymbol{U} \boldsymbol{R}_Z^{\mathrm{T}}\left(\frac{\pi}{2}\right) \boldsymbol{V}^{\mathrm{T}} \\
& \boldsymbol{t}_2^{\wedge}=\boldsymbol{U} \boldsymbol{R}_Z\left(-\frac{\pi}{2}\right) \boldsymbol{\Sigma} \boldsymbol{U}^{\mathrm{T}}, \quad \boldsymbol{R}_2=\boldsymbol{U} \boldsymbol{R}_Z^{\mathrm{T}}\left(-\frac{\pi}{2}\right) \boldsymbol{V}^{\mathrm{T}} 
\end{aligned}
$$





