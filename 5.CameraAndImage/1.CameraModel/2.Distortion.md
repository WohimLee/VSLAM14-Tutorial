&emsp;
# 单目相机 Monocular
## 1 单目相机模型
为了更好的接收光线，相机镜头上通常会配备透镜，这使得光线投影到成像平面的过程中会产生畸变

>单目相机模型
- 单目相机模型就是，在前面讲的针孔相机模型的基础上，使用 `针孔` 和 `畸变` 两个模型来描述整个投影过程

&emsp;
## 畸变
>径向畸变
- 由透镜形状引起的畸变称之为`径向畸变`。

    为了获得好的成像效果，我们在相机的前方加了透镜。透镜的加入对成像过程中光线的传播会产生新的影响: 
    - 一是透镜自身的形状对光线传播的影响

    - 二是在机械组装过程中，透镜和成像平面不可能完全平行，这也会使得光线穿过透镜投影到成像面时的位置发生变化。

    在针孔模型中，一条直线投影到像素平面上还是一条直线。可是，在实际拍摄的照片中，摄像机的透镜往往使得真实环境中的一条直线在图片中变成了曲线。越靠近图像的边缘，这种现象越明显。
    
    由于实际加工制作的透镜往往是中心对称的，这使得不规则的畸变通常径向对称。它们主要分为两大类：
    - 桶形畸变

    - 枕形畸变

    <div align="center">
        <image src="../imgs/5.1.2-1.png" width = 500>
    </div>
    &emsp;

    桶形畸变是由于图像放大率随着离光轴的距离增加而减小，而枕形畸变却恰好相反。

    在这两种畸变中，穿过图像中心和光轴有交点的直线还能保持形状不变。

&emsp;
>切向畸变
- 除了透镜的形状会引入径向畸变外，在相机的组装过程中由于不能使得透镜和成像面严格平行也会引入`切向畸变`。如图 5-4 所示。

    <div align="center">
        <image src="../imgs/5.1.2-2.png" width = 400>
    </div>
    &emsp;


&emsp;
## 2 两种畸变的数学表示
为更好地理解径向畸变和切向畸变，我们用更严格的数学形式对两者进行描述。

我们知道平面上的任意一点 $p$ 可以用笛卡尔坐标表示为 $[x, y]^T$ , 也可以把它写成极坐标的形式 $[r, θ]^T$
- $r$ 表示点 $p$ 离坐标系原点的距离

- $θ$ 表示和水平轴的夹角。
- 径向畸变可看成坐标点沿着 `长度方向` 发生了变化 $δr$, 也就是其 `距离原点的长度` 发生了变化
- 切向畸变可以看成坐标点沿着 `切线方向` 发生了变化，也就是 `水平夹角` 发生了变化 $δθ$。

&emsp;
>径向畸变
- 对于径向畸变，无论是桶形畸变还是枕形畸变，由于它们都是随着离中心的距离增加而增加。我们可以用一个多项式函数来描述畸变前后的坐标变化：这类畸变可以用和距中心距离有关的二次及高次多项式函数进行纠正：

    $$\begin{cases}
    x_{corrected} = x(1 + k_1r^2 + k_2r^4 + k_3r^6) \\
    y_{corrected} = y(1 + k_4r^2 + k_5r^4 + k_6r^6) 
    \end{cases} （5.11）$$

    其中 $[x, y]T$ 是未纠正的点的坐标，$[x_{corrected}, y_{corrected}]T$ 是纠正后的点的坐标，注意它们都是归一化平面上的点，而不是像素平面上的点。

    在式（5.11）描述的纠正模型中，对于畸变较小的图像中心区域，畸变纠正主要是 $k_1$ 起作用。而对于畸变较大的边缘区域主要是 $k_2$ 起作用。
    
    普通摄像头用这两个系数就能很好的纠正径向畸变。对畸变很大的摄像头，比如鱼眼镜头，可以加入 $k_3$ 畸变项对畸变进行纠正。

&emsp;
>切向畸变
- 另一方面，对于切向畸变，可以使用另外的两个参数 $p_1$, $p_2$ 来进行纠正:
    $$\begin{cases}
    x_{corrected} = x + 2p_1xy + p_2(r^2 + 2x^2) \\ 
    y_{corrected} = y + 2p_2xy + p_1(r^2 + 2y^2)
    \end{cases} （5.12）$$

    因此，联合式$（5.11）$和式$（5.12）$，对于相机坐标系中的一点 $P(X, Y, Z)$，我们能够通过五个畸变系数找到这个点在像素平面上的正确位置:
    1. 将三维空间点投影到归一化图像平面。设它的归一化坐标为 $[x, y]^T$。

    2. 对归一化平面上的点进行径向畸变和切向畸变纠正。
    $$\begin{cases}
    x_{corrected} = x(1 + k_1r^2 + k_2r^4 + k_3r^6) + 2p_1xy + p_2(r^2 + 2x^2)\\
    y_{corrected} = y(1 + k_4r^2 + k_5r^4 + k_6r^6) + 2p_2xy + p_1(r^2 + 2y^2)
    \end{cases} $$

    3. 将纠正后的点通过内参数矩阵投影到像素平面，得到该点在图像上的正确位置。
    $$\begin{cases}
    u = f_x x_{corrected} + c_x \\
    v = f_y y_{corrected} + c_y
    \end{cases} $$

    在上面的纠正畸变的过程中，我们使用了五个畸变项。实际应用中，可以灵活选择纠正模型，比如只选择 $k_1， p_1， p_2$ 这三项等。


